<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seguimiento de Proyectos - Bancolombia</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bancolombia-blue: #004884;
            --bancolombia-green: #00A859;
            --bancolombia-orange: #FF6B00;
            --bancolombia-gray: #F5F5F5;
            --bancolombia-red: #df0013; 
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: var(--bancolombia-gray);
            color: var(--bancolombia-dark-gray);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 10px 0;
            margin-bottom: 20px;
        }
        
        .logo-container {
            text-align: center;
            padding: 10px 0;
            margin: 0 auto;
            max-width: 1200px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo-container img {
            height: 50px;
            width: auto;
        }
        
        .breadcrumb {
            background-color: transparent;
            padding: 0;
            margin: 0;
            font-size: 0.9rem;
        }
        
        .breadcrumb-item.active {
            color: var(--bancolombia-blue);
            font-weight: 600;
        }
        
        .module-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding: 20px 0;
        }
        
        .module-title {
            color: var(--bancolombia-blue);
            font-weight: 700;
            margin-bottom: 30px;
            text-align: center;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .module-title i {
            margin-right: 15px;
            font-size: 1.5rem;
        }
        
        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .module-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: none;
            text-align: center;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .module-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }
        
        .module-card .card-header {
            background-color: var(--bancolombia-light-blue);
            color: white;
            font-size: 1.2rem;
            padding: 15px;
            font-weight: 600;
        }
        
        .module-card .card-body {
            padding: 25px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .module-card .card-list {
            text-align: left;
            margin-bottom: 20px;
            flex: 1;
        }
        
        .module-card .card-list-item {
            margin-bottom: 10px;
            padding-left: 25px;
            position: relative;
        }
        
        .module-card .card-list-item:before {
            content: "â€¢";
            color: var(--bancolombia-light-blue);
            font-weight: bold;
            position: absolute;
            left: 10px;
        }
        
        .module-card .btn-group {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        .btn-danger {
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        .module-card .btn {
            border: none;
            border-radius: 5px;
            padding: 8px 15px;
            font-weight: 600;
            min-width: 100px;
        }
        
        .btn-primary {
            background-color: var(--bancolombia-blue);
        }
        
        .btn-success {
            background-color: var(--bancolombia-green);
        }
        
        .btn-warning {
            background-color: var(--bancolombia-orange);
        }
        
        .btn-danger {
            background-color: var(--bancolombia-red);
        }
        
        .footer {
            background-color: var(--bancolombia-blue);
            color: white;
            padding: 20px 0;
            text-align: center;
            font-size: 0.9rem;
            margin-top: 40px;
        }

        
        .user-info {
            text-align: right;
            padding: 10px 20px;
            background-color: var(--bancolombia-gray);
            color: var(--bancolombia-dark-gray);
            font-size: 0.9rem;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }
        
        .container-aligned {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            width: 100%;
        }

        .seguimiento-container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 25px;
            margin: 20px 0;
        }

        .seguimiento-card {
            border-left: 4px solid var(--bancolombia-blue);
            margin: 15px 0;
            transition: all 0.3s ease;
        }

        .seguimiento-card:hover {
            transform: translateX(10px);
        }

        .estado-badge {
            font-size: 0.8rem;
            padding: 5px 10px;
            border-radius: 15px;
        }

        .btn-seguimiento {
            background-color: var(--bancolombia-blue);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
        }

        .btn-seguimiento:hover {
            background-color: #0066CC;
        }

        .nav-seguimiento {
            border-bottom: 2px solid var(--bancolombia-gray);
            margin-bottom: 20px;
        }

        .nav-link.active {
            color: var(--bancolombia-blue) !important;
            border-bottom: 3px solid var(--bancolombia-blue);
        }

        .formulario-seguimiento {
            background: var(--bancolombia-gray);
            border-radius: 10px;
            padding: 20px;
        }
        .error-mensaje {
            color: #dc3545;
            font-size: 0.875em;
            display: none;
        }

        .campo-invalido {
            border-color: #dc3545 !important;
        }

        .modal-confirmacion {
            background: rgba(0,0,0,0.4);
        }
        .estado-proyecto {
            font-size: 0.9rem;
            padding: 5px 15px;
            border-radius: 20px;
        }
        
        .activo { background: #d4edda; color: #155724; }
        .en-revision { background: #fff3cd; color: #856404; }
        .desistido { background: #f8d7da; color: #721c24; }
        .completado { background: #d1ecf1; color: #0c5460; }

        .timeline {
        position: relative;
        padding-left: 30px;
        margin: 20px 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 7px;
            top: 0;
            height: 100%;
            width: 2px;
            background: var(--bancolombia-blue);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 30px;
            padding-left: 30px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -4px;
            top: 5px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--bancolombia-blue);
            border: 3px solid white;
        }

        .timeline-date {
            font-weight: 600;
            color: var(--bancolombia-blue);
            margin-bottom: 5px;
        }

        .timeline-content {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }
        /* Para el selector de proyectos */
        #filtroProyecto, #selectorProyecto {
            border: 2px solid var(--bancolombia-blue);
            border-radius: 8px;
            padding: 0.75rem;
            transition: all 0.3s ease;
        }

        #filtroProyecto:hover, #selectorProyecto:hover {
            border-color: var(--bancolombia-light-blue);
            box-shadow: 0 0 8px rgba(0,104,255,0.1);
        }
        .modal-confirmacion .modal-header {
            background: var(--bancolombia-orange);
        }

        .modal-confirmacion .modal-title {
            color: white;
        }

        #confirmActionBtn {
            background: var(--bancolombia-orange);
            border: none;
        }

        #confirmActionBtn:hover {
            background: #ff8b33;
        }
        /* Reemplaza el CSS anterior por este */
        .btn-action {
            transform: scale(1);
            transition: all 0.3s ease;
            opacity: 0.8;
            margin: 0 3px;
            transform-origin: center;
        }

        .btn-action:hover {
            transform: scale(1.15);
            opacity: 1;
            z-index: 2;
        }

        .btn-action i {
            transition: transform 0.2s ease;
        }

        .btn-action:hover i {
            transform: scale(1.1);
        }
    </style>
</head>
<body>
     <!-- Header con logo y usuario -->
     <div class="header">
        <div class="container-aligned">
            <div class="user-info">
                <span class="role-badge me-3">{{ session.usuario.rol | title }}</span>
                <i class="fas fa-user-circle"></i> {{ session.usuario.nombre }}
                | <a href="{{ url_for('logout') }}"><i class="fas fa-sign-out-alt"></i> Cerrar sesiÃ³n</a>
            </div>
            <div class="logo-container">
                <img src="https://www.uam.edu.co/wp-content/uploads/2022/09/logo-bancolombia1.png" 
                     alt="Bancolombia">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="{{ url_for('menu_principal') }}"><i class="fas fa-home"></i> MenÃº Principal</a></li>
                        <li class="breadcrumb-item active" aria-current="page"><i class="fas fa-user-tie"></i> MÃ³dulo Pilotos</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>

    <!-- Contenido principal -->
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <a href="{{ url_for('modulo_pilotos') }}" class="btn btn-outline-secondary">
                <i class="fas fa-arrow-left me-2"></i>Volver
            </a>
    </div>
    <div class="card mb-4 shadow">
        <div class="card-body">
            <div class="row align-items-center">
                <div class="col-md-4">
                    <h5 class="mb-0"><i class="fas fa-project-diagram"></i> Proyecto a Seguir</h5>
                </div>
                <div class="col-md-8">
                    <select class="form-select" id="selectorProyecto" onchange="cargarSeguimientos()">
                        <option value="">Seleccione un proyecto...</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
    <div class="container mt-4">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2><i class="fas fa-clipboard-list me-2"></i>Seguimiento de Proyectos</h2>
            <button class="btn btn-seguimiento" onclick="mostrarFormulario()">
                <i class="fas fa-plus me-2"></i>Nuevo Seguimiento
            </button>
        </div>

        <!-- Listado de Seguimientos -->
        <div class="seguimiento-container">
            <nav class="nav nav-seguimiento">
                <a class="nav-link active" href="#">Todos</a>
                <a class="nav-link" href="#">Pendientes</a>
                <a class="nav-link" href="#">Completados</a>
            </nav>

            <div id="listado-seguimientos">
                <!-- DinÃ¡mico -->
            </div>
        </div>

        <!-- Formulario Nuevo Seguimiento -->
        <div class="seguimiento-container formulario-seguimiento" id="formulario" style="display: none;">
            <h4><i class="fas fa-file-alt me-2"></i>Nuevo Registro</h4>
            <form id="form-nuevo-seguimiento">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label>TÃ­tulo</label>
                        <input type="text" class="form-control" id="titulo" required>
                        <span class="error-mensaje"></span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label>Tipo</label>
                        <select class="form-select" id="tipo" required>
                            <option value="avance">Avance de Obra</option>
                            <option value="desembolso">Desembolso</option>
                            <option value="informe">Informe de Ventas</option>
                            <option value="modificacion">ModificaciÃ³n</option>
                        </select>
                        <span class="error-mensaje"></span>
                    </div>
                </div>
            
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label>Fecha</label>
                        <input type="date" class="form-control" id="fecha" required>
                        <span class="error-mensaje"></span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label>Estado</label>
                        <select class="form-select" id="estado" required>
                            <option value="pendiente">Pendiente</option>
                            <option value="completado">Completado</option>
                            <option value="revision">En RevisiÃ³n</option>
                        </select>
                        <span class="error-mensaje"></span>
                    </div>
                </div>
            
                <div class="mb-3">
                    <label>Contenido</label>
                    <textarea class="form-control" rows="4" id="contenido" required></textarea>
                    <span class="error-mensaje"></span>
                </div>

                <div class="d-flex justify-content-end gap-2">
                    <button type="button" class="btn btn-secondary" onclick="ocultarFormulario()">Cancelar</button>
                    <button type="submit" class="btn btn-seguimiento">Guardar</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Modal de ConfirmaciÃ³n -->
       <div class="modal fade modal-confirmacion" id="confirmModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-warning">
                    <h5 class="modal-title"><i class="fas fa-exclamation-triangle me-2"></i>Confirmar acciÃ³n</h5>
                </div>
                <div class="modal-body" id="confirmModalBody"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" id="confirmActionBtn">Confirmar</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal de Error -->
    <div class="modal fade" id="errorModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title"><i class="fas fa-exclamation-triangle"></i> Error</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p id="errorMensaje"></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
        <div id="error-general" class="alert alert-danger d-none mb-3"></div>
    </div>
    <!-- Modal de EdiciÃ³n -->
    <div class="modal fade" id="modalEdicion" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title"><i class="fas fa-edit me-2"></i>Editar Seguimiento</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="form-editar-seguimiento">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label>TÃ­tulo</label>
                                <input type="text" class="form-control" id="editar-titulo" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label>Tipo</label>
                                <select class="form-select" id="editar-tipo" required>
                                    <option value="avance">Avance de Obra</option>
                                    <option value="desembolso">Desembolso</option>
                                    <option value="informe">Informe de Ventas</option>
                                    <option value="modificacion">ModificaciÃ³n</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label>Fecha</label>
                                <input type="date" class="form-control" id="editar-fecha" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label>Estado</label>
                                <select class="form-select" id="editar-estado" required>
                                    <option value="pendiente">Pendiente</option>
                                    <option value="completado">Completado</option>
                                    <option value="revision">En RevisiÃ³n</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label>Contenido</label>
                            <textarea class="form-control" rows="4" id="editar-contenido" required></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                    </div>
                </form>
            </div>
        </div>
    </div> 
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script>
        let seguimientos = JSON.parse(localStorage.getItem('seguimientos')) || [];
        let editandoIndex = -1;
    
        const form = document.getElementById('form-nuevo-seguimiento');
        const campos = {
            titulo: document.getElementById('titulo'),
            tipo: document.getElementById('tipo'),
            fecha: document.getElementById('fecha'),
            estado: document.getElementById('estado'),
            contenido: document.getElementById('contenido')
        };
    
        Object.values(campos).forEach(campo => {
            campo.addEventListener('input', () => validarCampo(campo));
        });
    
        function validarCampo(campo) {
            const valor = campo.value.trim();
            const error = campo.nextElementSibling;
    
            if (!valor) {
                campo.classList.add('campo-invalido');
                error.textContent = 'Este campo es requerido';
                error.style.display = 'block';
                return false;
            }
    
            if (campo.type === 'date' && new Date(valor) > new Date()) {
                campo.classList.add('campo-invalido');
                error.textContent = 'La fecha no puede ser futura';
                error.style.display = 'block';
                return false;
            }
    
            campo.classList.remove('campo-invalido');
            error.textContent = '';
            error.style.display = 'none';
            return true;
        }
    
        function validarFormulario() {
            return Object.values(campos).every(validarCampo);
        }
    
        document.addEventListener('DOMContentLoaded', () => {
            cargarProyectosEnSelector();
            renderSeguimientos();
        });
    
        function cargarProyectosEnSelector() {
            const selector = document.getElementById('selectorProyecto');
            selector.innerHTML = '<option value="">Seleccione un proyecto...</option>';
            const proyectos = JSON.parse(localStorage.getItem('proyectos')) || [];
    
            proyectos.forEach(proyecto => {
                const option = document.createElement('option');
                option.value = proyecto.id;
                option.textContent = `${proyecto.nombre_proyecto}`;
                selector.appendChild(option);
            });
        }
    
        function cargarSeguimientos() {
            renderSeguimientos();
        }
    
        function mostrarFormulario(editar = false, index = -1) {
            form.reset();
            editandoIndex = index;
    
            if (editar) {
                const seg = seguimientos[index];
                campos.titulo.value = seg.titulo;
                campos.tipo.value = seg.tipo;
                campos.fecha.value = seg.fecha;
                campos.estado.value = seg.estado;
                campos.contenido.value = seg.contenido;
                document.querySelector('#formulario h4').textContent = 'Editar Seguimiento';
            } else {
                document.querySelector('#formulario h4').textContent = 'Nuevo Registro';
            }
    
            document.getElementById('formulario').style.display = 'block';
        }
    
        function ocultarFormulario() {
            form.reset();
            editandoIndex = -1;
            document.getElementById('formulario').style.display = 'none';
            Object.values(campos).forEach(campo => {
                campo.classList.remove('campo-invalido');
                const error = campo.nextElementSibling;
                if (error) {
                    error.textContent = '';
                    error.style.display = 'none';
                }
            });
        }
    
        function mostrarErrorModal(mensaje) {
            const modal = new bootstrap.Modal(document.getElementById('errorModal'));
            document.getElementById('errorMensaje').textContent = mensaje;
            modal.show();
        }
    
        function guardarSeguimiento() {
            const proyectoId = document.getElementById('selectorProyecto').value;
            
            if (!proyectoId) {
                mostrarErrorModal("Seleccione un proyecto primero");
                return;
            }

            if (!validarFormulario()) {
                mostrarErrorModal("Complete todos los campos requeridos");
                return;
            }

            const nuevoSeguimiento = {
                id: editandoIndex !== -1 ? seguimientos[editandoIndex].id : Date.now(),
                proyectoId,
                titulo: campos.titulo.value.trim(),
                tipo: campos.tipo.value,
                fecha: campos.fecha.value,
                estado: campos.estado.value,
                contenido: campos.contenido.value.trim(),
                usuario: "{{ session.usuario.nombre }}",
                fecha: obtenerFechaLocalISO(campos.fecha.value), // Usar funciÃ³n de formateo
            };

            if (editandoIndex !== -1) {
                seguimientos[editandoIndex] = nuevoSeguimiento;
            } else {
                seguimientos.push(nuevoSeguimiento);
            }

            localStorage.setItem('seguimientos', JSON.stringify(seguimientos));
            renderSeguimientos();
            ocultarFormulario();
        }
        
    
        function confirmarEliminacion(index) {
            const modal = new bootstrap.Modal(document.getElementById('confirmModal'));
            document.getElementById('confirmModalBody').textContent =
                'Â¿EstÃ¡ seguro que desea eliminar este seguimiento? Esta acciÃ³n no se puede deshacer.';
    
            document.getElementById('confirmActionBtn').onclick = () => {
                seguimientos.splice(index, 1);
                localStorage.setItem('seguimientos', JSON.stringify(seguimientos));
                renderSeguimientos();
                modal.hide();
            };
    
            modal.show();
        }
        // FunciÃ³n para editar un seguimiento
        function editarSeguimiento(index) {
            const seg = seguimientos[index];
            // Rellenar el formulario con los datos del seguimiento
            document.getElementById('titulo').value = seg.titulo;
            document.getElementById('tipo').value = seg.tipo;
            document.getElementById('fecha').value = seg.fecha;
            document.getElementById('estado').value = seg.estado;
            document.getElementById('contenido').value = seg.contenido;
            // Mostrar el modal
            mostrarFormulario(true, index);
        }

        // FunciÃ³n para eliminar un seguimiento
        function eliminarSeguimiento(index) {
            if (confirm('Â¿EstÃ¡s seguro de eliminar este seguimiento?')) {
                seguimientos.splice(index, 1);
                renderizarSeguimientos();
            }
        }    
        function filtrarSeguimientos(estado) {
            if (estado === 'todos') {
                return seguimientosFiltradosPorProyecto().sort((a, b) => new Date(b.fecha) - new Date(a.fecha));
            }
            return seguimientosFiltradosPorProyecto()
                .filter(seg => seg.estado === estado)
                .sort((a, b) => new Date(b.fecha) - new Date(a.fecha));
        }
    
        function seguimientosFiltradosPorProyecto() {
            const proyectoId = document.getElementById('selectorProyecto').value;
            return seguimientos.filter(s => s.proyectoId === proyectoId);
        }
    
        function renderSeguimientos(estadoFiltro = 'todos') {
            const container = document.getElementById('listado-seguimientos');
            const filtrados = filtrarSeguimientos(estadoFiltro);
            
            container.innerHTML = filtrados.length === 0 
                ? `<div class="alert alert-info">No hay seguimientos para este proyecto</div>`
                : `
                    <div class="timeline">
                        ${filtrados.map(seg => `
                            <div class="timeline-item">
                                <div class="timeline-date">
                                    ${new Date(seg.fecha + 'T00:00:00').toLocaleDateString('es-CO', {
                                        timeZone: 'America/Bogota',
                                        year: 'numeric',
                                        month: 'long',
                                        day: 'numeric'
                                    })}
                                    <span class="badge bg-${getEstadoColor(seg.estado)}">${seg.estado.toUpperCase()}</span>
                                </div>
                                <div class="timeline-content">
                                    <h5>${seg.titulo}</h5>
                                    <p class="text-muted">${seg.contenido}</p>
                                    <div class="d-flex gap-2 mt-2">
                                        <button class="btn btn-sm btn-primary btn-action" 
                                            onclick="editarPorId(${seg.id})"
                                            title="Editar">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn btn-sm btn-danger btn-action" 
                                            onclick="eliminarPorId(${seg.id})"
                                            title="Eliminar">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>`;
        }

        // FunciÃ³n para editar seguimiento (Actualizada)
        function editarPorId(id) {
            const seguimiento = seguimientos.find(seg => seg.id === id);
            if (!seguimiento) return;

            // Asegurar que proyectoId sea string
            document.getElementById('selectorProyecto').value = String(seguimiento.proyectoId);
            cargarSeguimientos();

            // Llenar formulario
            document.getElementById('editar-titulo').value = seguimiento.titulo;
            document.getElementById('editar-tipo').value = seguimiento.tipo;
            document.getElementById('editar-fecha').value = seguimiento.fecha;
            document.getElementById('editar-estado').value = seguimiento.estado;
            document.getElementById('editar-contenido').value = seguimiento.contenido;

            const form = document.getElementById('form-editar-seguimiento');
            form.onsubmit = (e) => {
                e.preventDefault();
                
                // Actualizar datos (convertir proyectoId a string)
                seguimiento.titulo = document.getElementById('editar-titulo').value;
                seguimiento.tipo = document.getElementById('editar-tipo').value;
                seguimiento.fecha = document.getElementById('editar-fecha').value;
                seguimiento.estado = document.getElementById('editar-estado').value;
                seguimiento.contenido = document.getElementById('editar-contenido').value;
                seguimiento.proyectoId = String(document.getElementById('selectorProyecto').value); // <- ConversiÃ³n a string

                localStorage.setItem('seguimientos', JSON.stringify(seguimientos));
                cargarSeguimientos();
                bootstrap.Modal.getInstance(document.getElementById('modalEdicion')).hide();
            };

            new bootstrap.Modal(document.getElementById('modalEdicion')).show();
        }

        // FunciÃ³n para cargar seguimientos (Actualizada)
        function cargarSeguimientos() {
            const proyectoId = String(document.getElementById('selectorProyecto').value); // <- Asegurar string
            renderSeguimientos();
        }

        // FunciÃ³n para eliminar con modal
        function eliminarPorId(id) {
            const modal = new bootstrap.Modal(document.getElementById('confirmModal'));
            const seguimiento = seguimientos.find(seg => seg.id === id);
            
            document.getElementById('confirmModalBody').innerHTML = `
                <p>Â¿EstÃ¡ seguro de eliminar el seguimiento:</p>
                <h5 class="text-danger">${seguimiento.titulo}</h5>
                <p>Esta acciÃ³n no se puede deshacer</p>
            `;
            
            document.getElementById('confirmActionBtn').onclick = () => {
                seguimientos = seguimientos.filter(seg => seg.id !== id);
                localStorage.setItem('seguimientos', JSON.stringify(seguimientos));
                renderSeguimientos();
                modal.hide();
            };
            
            modal.show();
        }

        // FunciÃ³n para filtrar (Actualizada)
        function seguimientosFiltradosPorProyecto() {
            const proyectoId = String(document.getElementById('selectorProyecto').value); // <- Comparar como strings
            return seguimientos.filter(s => String(s.proyectoId) === proyectoId);
        }
    
        function getEstadoColor(estado) {
            const colores = {
                pendiente: 'warning',
                completado: 'success',
                revision: 'primary'
            };
            return colores[estado] || 'secondary';
        }
    
        form.addEventListener('submit', function (e) {
            e.preventDefault();
            guardarSeguimiento();
        });

        function obtenerFechaLocalISO(inputDate) {
            const fecha = new Date(inputDate);
            const offset = fecha.getTimezoneOffset() * 60000; // Offset en milisegundos
            return new Date(fecha.getTime() - offset).toISOString().split('T')[0];
        }
    
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
    
                const filtro = this.textContent.trim().toLowerCase();
                const estadoFiltro = {
                    'todos': 'todos',
                    'pendientes': 'pendiente',
                    'completados': 'completado'
                }[filtro];
    
                renderSeguimientos(estadoFiltro);
            });
        });
    </script>
     <!-- Footer -->
     <div class="footer">
        <div class="container-aligned">
            <p>Â© 2025 Bancolombia. Todos los derechos reservados.</p>
            <p>
                <a href="#">TÃ©rminos y condiciones</a> | 
                <a href="#">PolÃ­tica de privacidad</a> | 
                <a href="#">Ayuda</a>
            </p>
            <p>
                <i class="fas fa-phone"></i> LÃ­nea de atenciÃ³n: 01 8000 912 345 | 
                <i class="fas fa-map-marker-alt"></i> Sede principal: MedellÃ­n, Colombia
            </p>
        </div>
    </div>    
</body>
</html>